include "../cameras/canon_40d.pyr" as response_curves
include "colors.pyr" as colors
include "lamp.pyr" as lamp

image = {
	width = 512
	height = 512
	format = Image.Png
	rgb_curves = response_curves
}

renderer = Renderer.Bidirectional {
	pixel_samples = 3000
	spectrum.samples = 20
	spectrum.bins = 50
	spectrum.span = [370, 770]
	tile_size = 32
	bounces = 3
	light_samples = 1
	light_bounces = 3
}

camera = Camera.Perspective {
	fov = 15
	transform = Transform.LookAt
	transform.from = Vector(-2.78, -8, 2.73)
	transform.to = Vector(-4, 0.5, 1)
	transform.up = Vector { z=1 }
}

light = Material.Emission {
	color = Color.Spectrum(lamp.color)
}

white = Material.Diffuse {
	color = Color.Spectrum(colors.white)
}

green = Material.Diffuse {
	color = Color.Spectrum(colors.green)
}

red = Material.Diffuse {
	color = Color.Spectrum(colors.red)
}
			min = Vector(-5, 0, 0)
			max = Vector(-3, 2, 2)

world.sky = Sky.Color(0)
world.objects = [
	Shape.Mesh {
		file = "box.obj"
		materials.light = light
		materials.left = red
		materials.right = green

		materials.tall = white
		materials.short = white
		materials.back = white
		materials.ceiling = white
		materials.floor = white
	},
	Shape.RayMarched {
		shape = RayMarched.QuaternionJulia {
			iterations = 50
			threshold = 4
			constant = Vector(-0.2,0.8,0,0)
			slice_plane = 0
			type = QuaternionJulia.Cubic
		}

		bounds = Bounds.Box {
			min = Vector(-7, -1, 0)
			max = Vector(-1, 2, 2)
		}

		material = Material.FresnelMix {
			refract = Material.Diffuse(0.8)
			reflect = Material.Mirror(1)
			ior = 1.5
		}
	}
]
